<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>User Registration</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <h1>Sign Up with MDash</h1>
    <p>Example user: user / password </p>
    <form>
      <div th:if="${param.error}" class="alert alert-error">
	Whoops, try again.
      </div>
      <label for="username">Username</label>:
      <input type="text" id="username" name="username" placeholder="Kvothe" required="true" autofocus="true" autocorrect="off" /> <br/>
      <label for="password">Password</label>:
      <input type="password" id="password" name="password" placeholder="TemerantSecrets"/> <br/>
      <input type="submit" onclick="newUser()" value="Submit"/>
    </form>
    <p><a href="/" th:href="@{/}"> Back to home page</a></p>
    <script>
      function newUser() {
      var data = new FormData();
      var response = "";
      data.append("username", username);
      data.append("password", password);

      var xhr = new XMLHttpRequest();
      xhr.withCredentials = true;
      xhr.addEventListener("readystatechange", function() {
      if (xhr.readyState===4) {
       response = xhr.status;
      }
      });

      xhr.open("POST", "http://143.229.6.40:8082/users");
      xhr.setRequestHeader("Accept","application/json");
      xhr.setRequestHeader("Content-Type", "application/json");
      xhr.send(data);
      document.write(response);
      }
    </script>
  </body>
</html>
